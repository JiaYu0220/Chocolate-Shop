import{m as g,a as _,_ as C,o as a,e as s,b as e,n as k,t as n,c as p,w as y,g as u,d as b,F as m,f,j as v,G as S,r as x,i as q}from"./index-UQyU5R_d.js";import{c as h}from"./cartStore-Dl4gRdkf.js";import{l as L}from"./loadingStore-BnruwvD2.js";import{L as N}from"./LoadingBtn-B1JaIm-u.js";const j={props:{cart:Object,canEdit:{type:Boolean,default:!0},swalContainer:[Object,String]},inject:{hasDelSwal:{from:"hasDelSwal",default:!0}},components:{LoadingBtn:N},data(){return{qty:null}},mounted(){this.qty=this.cart.qty},methods:{reduceQty(){this.qty===1?this.delCart(this.cart,this.swalContainer):(this.qty-=1,this.debouncePutCart(this.cart,this.qty))},addQty(){this.qty+=1,this.debouncePutCart(this.cart,this.qty)},...g(h,["debouncePutCart","delCart"])},watch:{"cart.qty":{handler(){this.qty=this.cart.qty},deep:!0}},computed:{..._(L,["loadingStatus"])}},B={ref:"card",class:"flex items-center gap-2 rounded sm:gap-4"},E={class:"h-28 w-1/3 overflow-hidden rounded-md sm:h-32"},I=["src"],D={class:"flex w-2/3 flex-col justify-between"},T={class:"font-medium sm:text-lg"},V={key:0,class:"bi bi-trash3 text-orange-700"},O={class:"mb-1 text-sm text-stone-500 sm:text-base"},Q={class:"mb-1"},A={key:0,class:"mr-2 text-xs text-stone-500 sm:text-sm"},P={class:"text-primary-800"},z={class:"flex items-center justify-between gap-1"},F={key:0,class:"flex w-fit rounded border-2 border-primary-200 text-sm *:px-2 *:py-1 sm:text-base *:sm:px-3"},U={key:1},G={class:"font-bold text-primary-800 sm:text-lg"};function M(r,i,t,w,d,o){const l=x("LoadingBtn");return a(),s("li",B,[e("div",E,[e("img",{loading:"lazy",class:"h-full w-full object-cover",src:t.cart.product.imageUrl,alt:"產品圖"},null,8,I)]),e("div",D,[e("div",{class:k({"flex justify-between":t.canEdit})},[e("p",T,n(t.cart.product.title),1),t.canEdit?(a(),p(l,{key:0,class:"btn btn-link -mr-3 -mt-2 shadow-none",onClick:i[0]||(i[0]=c=>r.delCart(t.cart,t.swalContainer,o.hasDelSwal)),isLoading:r.loadingStatus.cartId===t.cart.id},{default:y(()=>[r.loadingStatus.cartId!==t.cart.id?(a(),s("i",V)):u("",!0)]),_:1},8,["isLoading"])):u("",!0)],2),e("p",O,n(t.cart.product.unit),1),e("p",Q,[t.cart.product.origin_price!==t.cart.product.price?(a(),s("del",A," NT$ "+n(t.cart.product.origin_price),1)):u("",!0),e("span",P,"NT$ "+n(t.cart.product.price),1)]),e("div",z,[t.canEdit?(a(),s("div",F,[b(l,{class:"transition-colors hover:bg-primary-200 focus:bg-primary-200 active:bg-primary-200 disabled:cursor-not-allowed disabled:bg-stone-100/50 disabled:text-stone-500",onClick:o.reduceQty,isLoading:r.loadingStatus.cartId===t.cart.id},{default:y(()=>[r.loadingStatus.cartId!==t.cart.id?(a(),s(m,{key:0},[f("－")],64)):u("",!0)]),_:1},8,["onClick","isLoading"]),v(e("input",{type:"text",class:"w-9 border-x border-y-0 border-primary-200 bg-transparent text-center text-sm focus:ring-primary-700 sm:w-11 sm:text-base","onUpdate:modelValue":i[1]||(i[1]=c=>d.qty=c),readonly:""},null,512),[[S,d.qty]]),b(l,{class:"transition-colors hover:bg-primary-200 focus:bg-primary-200 active:bg-primary-200 disabled:cursor-not-allowed disabled:text-stone-600",onClick:o.addQty,isLoading:r.loadingStatus.cartId===t.cart.id},{default:y(()=>[r.loadingStatus.cartId!==t.cart.id?(a(),s(m,{key:0},[f("＋")],64)):u("",!0)]),_:1},8,["onClick","isLoading"])])):(a(),s("p",U,"數量："+n(t.cart.qty),1)),e("p",G,"NT$ "+n(t.cart.total),1)])])],512)}const H=C(j,[["render",M]]),J={props:{propCarts:{type:Object,default:null},canEdit:{type:Boolean,default:!0}},components:{CartCard:H},data(){return{swalContainer:null}},mounted(){this.swalContainer=this.$refs.cardList.closest("dialog")||"body"},methods:{...g(h,["delAllCart"])},computed:{myCarts(){return this.propCarts!==null?this.propCarts:this.carts},myNum(){return this.propCarts!==null?Object.keys(this.propCarts).length:this.cartNum},..._(h,["cartNum","carts"])}},K={key:0,class:"flex items-center justify-between pb-4"},R={key:1,class:"pb-4"},W={ref:"cardList",class:"flex flex-col gap-6 sm:gap-8"};function X(r,i,t,w,d,o){const l=x("CartCard");return a(),s(m,null,[t.canEdit?(a(),s("div",K,[e("p",null,"共 "+n(r.cartNum)+" 項商品",1),e("button",{class:"btn btn-link text-orange-800",type:"button",onClick:i[0]||(i[0]=c=>r.delAllCart(d.swalContainer))}," 清空購物車 ")])):(a(),s("p",R,"共 "+n(o.myNum)+" 項商品",1)),e("ul",W,[(a(!0),s(m,null,q(o.myCarts,c=>(a(),p(l,{key:c.id,cart:c,"can-edit":t.canEdit,"swal-container":d.swalContainer},null,8,["cart","can-edit","swal-container"]))),128))],512)],64)}const et=C(J,[["render",X]]);export{et as C};
