import{m as g,a as p,_,o as a,e as r,b as e,n as w,t as i,c as C,w as y,g as l,d as b,F as u,f,j as v,G as q,r as x,i as L}from"./index-BlwYnNT9.js";import{c as h}from"./cartStore-B1X95usn.js";import{l as N}from"./loadingStore-C2Adm8Kl.js";import{L as S}from"./LoadingBtn-DuRczD8e.js";const j={props:{cart:Object,canEdit:{type:Boolean,default:!0}},components:{LoadingBtn:S},data(){return{qty:null}},mounted(){this.qty=this.cart.qty},methods:{reduceQty(){this.qty===1?this.delCart(this.cart,this.refs.card):(this.qty-=1,this.debouncePutCart(this.cart,this.qty))},addQty(){this.qty+=1,this.debouncePutCart(this.cart,this.qty)},...g(h,["debouncePutCart","delCart"])},watch:{"cart.qty":{handler(){this.qty=this.cart.qty},deep:!0}},computed:{...p(N,["loadingStatus"])}},B={ref:"card",class:"flex items-center gap-2 rounded sm:gap-4"},E={class:"h-28 w-1/3 overflow-hidden rounded-md sm:h-32"},I=["src"],T={class:"flex w-2/3 flex-col justify-between"},V={class:"font-medium sm:text-lg"},Q={key:0,class:"bi bi-trash3 text-orange-700"},A={class:"mb-1 text-sm text-stone-500 sm:text-base"},O={class:"mb-1"},P={key:0,class:"mr-2 text-xs text-stone-500 sm:text-sm"},z={class:"text-primary-800"},D={class:"flex items-center justify-between gap-1"},F={key:0,class:"flex w-fit rounded border-2 border-primary-200 text-sm *:px-2 *:py-1 sm:text-base *:sm:px-3"},U={key:1},G={class:"font-bold text-primary-800 sm:text-lg"};function M(s,n,t,k,m,c){const d=x("LoadingBtn");return a(),r("li",B,[e("div",E,[e("img",{loading:"lazy",class:"h-full w-full object-cover",src:t.cart.product.imageUrl,alt:"產品圖"},null,8,I)]),e("div",T,[e("div",{class:w({"flex justify-between":t.canEdit})},[e("p",V,i(t.cart.product.title),1),t.canEdit?(a(),C(d,{key:0,class:"btn btn-link -mr-3 -mt-2 shadow-none",onClick:n[0]||(n[0]=o=>s.delCart(t.cart,!1)),isLoading:s.loadingStatus.cartId===t.cart.id},{default:y(()=>[s.loadingStatus.cartId!==t.cart.id?(a(),r("i",Q)):l("",!0)]),_:1},8,["isLoading"])):l("",!0)],2),e("p",A,i(t.cart.product.unit),1),e("p",O,[t.cart.product.origin_price!==t.cart.product.price?(a(),r("del",P," NT$ "+i(t.cart.product.origin_price),1)):l("",!0),e("span",z,"NT$ "+i(t.cart.product.price),1)]),e("div",D,[t.canEdit?(a(),r("div",F,[b(d,{class:"transition-colors hover:bg-primary-200 focus:bg-primary-200 active:bg-primary-200 disabled:cursor-not-allowed disabled:bg-stone-100/50 disabled:text-stone-500",onClick:c.reduceQty,isLoading:s.loadingStatus.cartId===t.cart.id},{default:y(()=>[s.loadingStatus.cartId!==t.cart.id?(a(),r(u,{key:0},[f("－")],64)):l("",!0)]),_:1},8,["onClick","isLoading"]),v(e("input",{type:"text",class:"w-9 border-x border-y-0 border-primary-200 bg-transparent text-center text-sm focus:ring-primary-700 sm:w-11 sm:text-base","onUpdate:modelValue":n[1]||(n[1]=o=>m.qty=o),readonly:""},null,512),[[q,m.qty]]),b(d,{class:"transition-colors hover:bg-primary-200 focus:bg-primary-200 active:bg-primary-200 disabled:cursor-not-allowed disabled:text-stone-600",onClick:c.addQty,isLoading:s.loadingStatus.cartId===t.cart.id},{default:y(()=>[s.loadingStatus.cartId!==t.cart.id?(a(),r(u,{key:0},[f("＋")],64)):l("",!0)]),_:1},8,["onClick","isLoading"])])):(a(),r("p",U,"數量："+i(t.cart.qty),1)),e("p",G,"NT$ "+i(t.cart.total),1)])])],512)}const H=_(j,[["render",M]]),J={props:{propCarts:{type:Object,default:null},canEdit:{type:Boolean,default:!0}},components:{CartCard:H},methods:{...g(h,["delAllCart"])},computed:{myCarts(){return this.propCarts!==null?this.propCarts:this.carts},myNum(){return this.propCarts!==null?Object.keys(this.propCarts).length:this.cartNum},...p(h,["cartNum","carts"])}},K={key:0,class:"flex items-center justify-between pb-4"},R={key:1,class:"pb-4"},W={ref:"cartList",class:"flex flex-col gap-6 sm:gap-8"};function X(s,n,t,k,m,c){const d=x("CartCard");return a(),r(u,null,[t.canEdit?(a(),r("div",K,[e("p",null,"共 "+i(s.cartNum)+" 項商品",1),e("button",{class:"btn btn-link text-orange-800",type:"button",onClick:n[0]||(n[0]=o=>s.delAllCart(s.$refs.cartList))}," 清空購物車 ")])):(a(),r("p",R,"共 "+i(c.myNum)+" 項商品",1)),e("ul",W,[(a(!0),r(u,null,L(c.myCarts,o=>(a(),C(d,{key:o.id,cart:o,"can-edit":t.canEdit},null,8,["cart","can-edit"]))),128))],512)],64)}const et=_(J,[["render",X]]);export{et as C};
