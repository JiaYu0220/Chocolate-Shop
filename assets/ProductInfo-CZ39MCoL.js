import{u as ue,x as E,y as W,z as de,A as fe,o as T,e as O,b as u,B as me,C as L,D as X,n as Z,E as J,g as H,_ as ge,m as z,a as pe,c as ve,w as R,r as B,j as K,v as he,d as C,i as Q,F as V,t as I,f as F,G as be,p as ye,k as we}from"./index-hIBv_cFW.js";import{l as ee}from"./loadingStore-DNIkVO7R.js";import{c as xe}from"./cartStore-DdOrrH1A.js";import{r as Se}from"./ProductCard-CQpxYrAi.js";import{L as Te}from"./LoadingBtn-BuU4Qp6P.js";import{P as Oe}from"./ProductSwiper-CqoreQbL.js";import{p as $e}from"./productStore-CHJpRlEh.js";import{T as _e}from"./TransitionFade-DMq-VEB3.js";import{s as je}from"./swalStore-BXANR3GM.js";var Ee=Object.defineProperty,Le=Object.defineProperties,Ie=Object.getOwnPropertyDescriptors,te=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,ke=Object.prototype.propertyIsEnumerable,re=(e,t,r)=>t in e?Ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Me=(e,t)=>{for(var r in t||(t={}))Pe.call(t,r)&&re(e,r,t[r]);if(te)for(var r of te(t))ke.call(t,r)&&re(e,r,t[r]);return e},Be=(e,t)=>Le(e,Ie(t)),$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ce="Expected a function",oe=NaN,We="[object Symbol]",ze=/^\s+|\s+$/g,Ae=/^[-+]0x[0-9a-f]+$/i,Ne=/^0b[01]+$/i,Re=/^0o[0-7]+$/i,Ve=parseInt,Fe=typeof $=="object"&&$&&$.Object===Object&&$,De=typeof self=="object"&&self&&self.Object===Object&&self,qe=Fe||De||Function("return this")(),Ue=Object.prototype,Xe=Ue.toString,He=Math.max,Ye=Math.min,D=function(){return qe.Date.now()};function Ge(e,t,r){var s,o,g,c,n,d,p=0,x=!1,f=!1,v=!0;if(typeof e!="function")throw new TypeError(Ce);t=ie(t)||0,Y(r)&&(x=!!r.leading,f="maxWait"in r,g=f?He(ie(r.maxWait)||0,t):g,v="trailing"in r?!!r.trailing:v);function b(i){var m=s,a=o;return s=o=void 0,p=i,c=e.apply(a,m),c}function P(i){return p=i,n=setTimeout(w,t),x?b(i):c}function k(i){var m=i-d,a=i-p,l=t-m;return f?Ye(l,g-a):l}function S(i){var m=i-d,a=i-p;return d===void 0||m>=t||m<0||f&&a>=g}function w(){var i=D();if(S(i))return _(i);n=setTimeout(w,k(i))}function _(i){return n=void 0,v&&s?b(i):(s=o=void 0,c)}function j(){n!==void 0&&clearTimeout(n),p=0,s=d=o=n=void 0}function M(){return n===void 0?c:_(D())}function y(){var i=D(),m=S(i);if(s=arguments,o=this,d=i,m){if(n===void 0)return P(d);if(f)return n=setTimeout(w,t),b(d)}return n===void 0&&(n=setTimeout(w,t)),c}return y.cancel=j,y.flush=M,y}function Y(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Ze(e){return!!e&&typeof e=="object"}function Je(e){return typeof e=="symbol"||Ze(e)&&Xe.call(e)==We}function ie(e){if(typeof e=="number")return e;if(Je(e))return oe;if(Y(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Y(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(ze,"");var r=Ne.test(e);return r||Re.test(e)?Ve(e.slice(2),r?2:8):Ae.test(e)?oe:+e}var Ke=Ge,le="Expected a function",ne=NaN,Qe="[object Symbol]",et=/^\s+|\s+$/g,tt=/^[-+]0x[0-9a-f]+$/i,rt=/^0b[01]+$/i,ot=/^0o[0-7]+$/i,it=parseInt,nt=typeof $=="object"&&$&&$.Object===Object&&$,st=typeof self=="object"&&self&&self.Object===Object&&self,at=nt||st||Function("return this")(),lt=Object.prototype,ct=lt.toString,ut=Math.max,dt=Math.min,q=function(){return at.Date.now()};function ft(e,t,r){var s,o,g,c,n,d,p=0,x=!1,f=!1,v=!0;if(typeof e!="function")throw new TypeError(le);t=se(t)||0,A(r)&&(x=!!r.leading,f="maxWait"in r,g=f?ut(se(r.maxWait)||0,t):g,v="trailing"in r?!!r.trailing:v);function b(i){var m=s,a=o;return s=o=void 0,p=i,c=e.apply(a,m),c}function P(i){return p=i,n=setTimeout(w,t),x?b(i):c}function k(i){var m=i-d,a=i-p,l=t-m;return f?dt(l,g-a):l}function S(i){var m=i-d,a=i-p;return d===void 0||m>=t||m<0||f&&a>=g}function w(){var i=q();if(S(i))return _(i);n=setTimeout(w,k(i))}function _(i){return n=void 0,v&&s?b(i):(s=o=void 0,c)}function j(){n!==void 0&&clearTimeout(n),p=0,s=d=o=n=void 0}function M(){return n===void 0?c:_(q())}function y(){var i=q(),m=S(i);if(s=arguments,o=this,d=i,m){if(n===void 0)return P(d);if(f)return n=setTimeout(w,t),b(d)}return n===void 0&&(n=setTimeout(w,t)),c}return y.cancel=j,y.flush=M,y}function mt(e,t,r){var s=!0,o=!0;if(typeof e!="function")throw new TypeError(le);return A(r)&&(s="leading"in r?!!r.leading:s,o="trailing"in r?!!r.trailing:o),ft(e,t,{leading:s,maxWait:t,trailing:o})}function A(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function gt(e){return!!e&&typeof e=="object"}function pt(e){return typeof e=="symbol"||gt(e)&&ct.call(e)==Qe}function se(e){if(typeof e=="number")return e;if(pt(e))return ne;if(A(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=A(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(et,"");var r=rt.test(e);return r||ot.test(e)?it(e.slice(2),r?2:8):tt.test(e)?ne:+e}var ae=mt;const vt=["src"],ht={inheritAttrs:!1},G=ue(Be(Me({},ht),{props:{src:{default:""},width:{default:"100%"},height:{default:"auto"},className:{default:""},zoomImgSrc:{default:""},zoomFactor:{default:1.5},mgWidth:{default:150},mgHeight:{default:150},mgBorderWidth:{default:2},mgShape:{default:"circle"},mgShowOverflow:{type:Boolean,default:!0},mgMouseOffsetX:{default:0},mgMouseOffsetY:{default:0},mgTouchOffsetX:{default:()=>-50},mgTouchOffsetY:{default:()=>-50},mgShow:{type:Boolean,default:!0},mgCornerBgColor:{default:"#fff"}},emits:["image:load"],setup(e,{emit:t}){const r=E();let s=E(new DOMRect),o=E(!1),g=E(0),c=E(0),n=E(0),d=E(0);const p=W(()=>{let a="vue-magnifier__magnifying-glass";return o.value&&(a+=" vue-magnifier__visible"),e.mgShape==="circle"&&(a+=" vue-magnifier__circle"),a}),x=W(()=>({width:e.width,height:e.height,overflow:e.mgShowOverflow?"visible":"hidden"})),f=W(()=>({cursor:e.mgShow?"none":"",width:"100%",height:"100%"})),v=W(()=>({width:`${e.mgWidth}px`,height:`${e.mgHeight}px`,left:`calc(${n.value*100}% - ${e.mgWidth/2}px + ${g.value}px - ${e.mgBorderWidth}px)`,top:`calc(${d.value*100}% - ${e.mgHeight/2}px + ${c.value}px - ${e.mgBorderWidth}px)`,backgroundImage:`url(${e.zoomImgSrc||e.src})`,backgroundPosition:`calc(${n.value*100}% + ${e.mgWidth/2}px - ${n.value*e.mgWidth}px) calc(${d.value*100}% + ${e.mgHeight/2}px - ${d.value*e.mgWidth}px)`,backgroundSize:`${e.zoomFactor*s.value.width}% ${e.zoomFactor*s.value.height}%`,borderWidth:`${e.mgBorderWidth}px`,backgroundColor:e.mgCornerBgColor})),b=()=>{r.value&&(s.value=r.value.getBoundingClientRect())},P=a=>{t("image:load",a),b()},k=()=>{b()};let S=a=>{if(s.value){const l=a.target;g.value=e.mgMouseOffsetX,c.value=e.mgMouseOffsetY,n.value=(a.clientX-s.value.left)/l.clientWidth,d.value=(a.clientY-s.value.top)/l.clientHeight,o.value=!0}};const w=()=>{o.value=!1},_=()=>{b()};let j=a=>{if(s.value){const l=a.target,h=(a.targetTouches[0].clientX-s.value.left)/l.clientWidth,N=(a.targetTouches[0].clientY-s.value.top)/l.clientHeight;h>=0&&N>=0&&h<=1&&N<=1?(g.value=e.mgTouchOffsetX,c.value=e.mgTouchOffsetY,n.value=h,d.value=N,o.value=!0):o.value=!1}};const M=()=>{o.value=!1},y=Ke(b,200);S=ae(S,20,{trailing:!1}),j=ae(j,20,{trailing:!1});const i=()=>{window.addEventListener("resize",y),window.addEventListener("scroll",y,!0)},m=()=>{window.removeEventListener("resize",y),window.removeEventListener("scroll",y,!0)};return de(()=>{i()}),fe(()=>{m()}),(a,l)=>(T(),O("div",{class:Z(`vue-magnifier__magnifier ${e.className}`),style:J(L(x))},[u("img",me({ref_key:"img",ref:r,src:e.src},a.$attrs,{class:"vue-magnifier__magnifier-image",style:L(f),onLoad:l[0]||(l[0]=h=>P(h)),onMouseenter:l[1]||(l[1]=h=>k()),onMousemove:l[2]||(l[2]=h=>L(S)(h)),onMouseout:l[3]||(l[3]=h=>w()),onTouchstart:l[4]||(l[4]=X(h=>_(),["prevent"])),onTouchmove:l[5]||(l[5]=X(h=>L(j)(h),["prevent"])),onTouchend:l[6]||(l[6]=h=>M())}),null,16,vt),s.value&&e.mgShow?(T(),O("div",{key:0,class:Z(L(p)),style:J(L(v))},null,6)):H("",!0)],6))}}));G.install=e=>{e.component("VueMagnifier",G)};var U,bt=["scroll","wheel","touchstart","touchmove","touchenter","touchend","touchleave","mouseout","mouseleave","mouseup","mousedown","mousemove","mouseenter","mousewheel","mouseover"];if(function(){var e=!1;try{var t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return e}()){var yt=EventTarget.prototype.addEventListener;U=yt,EventTarget.prototype.addEventListener=function(e,t,r){var s,o=typeof r=="object"&&r!==null,g=o?r.capture:r;(r=o?function(c){var n=Object.getOwnPropertyDescriptor(c,"passive");return n&&n.writable!==!0&&n.set===void 0?Object.assign({},c):c}(r):{}).passive=(s=r.passive)!==void 0?s:bt.indexOf(e)!==-1&&!0,r.capture=g!==void 0&&g,U.call(this,e,t,r)},EventTarget.prototype.addEventListener._original=U}var wt={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"jiayu",BASE_URL:"/Chocolate-Shop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:xt,VITE_PATH:St}=wt,Tt={props:["id"],components:{LoadingBtn:Te,ProductSwiper:Oe,VueMagnifier:G,TransitionFade:_e},data(){return{product:{},qty:1}},mounted(){Se(),this.init()},watch:{"$route.params.id":{handler(){this.getSingleProduct()},deep:!0}},methods:{async init(){this.showLoading();const e=[this.getAllProducts(),this.getSingleProduct()];(await Promise.allSettled(e)).forEach(r=>{r.status==="rejected"&&(this.hideLoading(),this.$swal(r.response.data))}),this.hideLoading()},async getSingleProduct(){try{this.showLoading();const e=`${xt}/api/${St}/product/${this.id}`,t=await this.$http.get(e);this.product=t.data.product,this.hideLoading()}catch(e){this.hideLoading(),this.apiErrorSwal(e)}},...z(xe,["postCart"]),...z(ee,["showLoading","hideLoading"]),...z($e,["getAllProducts"]),...z(je,["apiErrorSwal"])},computed:{...pe(ee,["loadingStatus"])}},ce=e=>(ye("data-v-a3d9ce09"),e=e(),we(),e),Ot={class:"container py-10"},$t={class:"flex flex-col pb-16 md:flex-row xl:w-4/5 xl:mx-auto"},_t={class:"pb-5 md:w-1/2 md:pb-0 md:pr-4 md:max-w-[450px]"},jt={class:"mx-auto w-full *:overflow-hidden *:rounded-sm","thumbs-swiper":".thumbs","space-between":"10",navigation:"true"},Et={lazy:"true"},Lt={class:"thumbs h-1/5 pt-2 *:h-full *:w-1/4 *:cursor-pointer *:overflow-hidden *:rounded-sm *:opacity-40","slides-per-view":"4","space-between":"10","watch-slides-progress":"true"},It={lazy:"true"},Pt=["src"],kt=["src"],Mt={class:"relative flex flex-col justify-between md:flex-grow md:pl-4"},Bt={class:"mb-3 text-2xl font-bold text-primary-800"},Ct={class:"mb-5"},Wt={class:"mb-5"},zt={class:"mb-5"},At={class:"mb-5"},Nt={class:"mr-1 text-2xl text-primary-800"},Rt={key:0},Vt=ce(()=>u("p",null,"數量",-1)),Ft={class:"mb-5 flex w-fit rounded border-2 border-primary-700 *:px-3 *:py-2"},Dt=["disabled"],qt={class:"pb-5 pt-16 flex items-center justify-between"},Ut=ce(()=>u("h2",{class:"text-xl font-bold text-primary-800"},"推薦商品",-1));function Xt(e,t,r,s,o,g){const c=B("VueMagnifier"),n=B("LoadingBtn"),d=B("RouterLink"),p=B("ProductSwiper"),x=B("TransitionFade");return T(),ve(x,null,{default:R(()=>[K(u("div",Ot,[u("div",$t,[u("div",_t,[u("swiper-container",jt,[u("swiper-slide",Et,[C(c,{src:o.product.imageUrl,class:"aspect-square object-cover"},null,8,["src"])]),(T(!0),O(V,null,Q(o.product.imagesUrl,(f,v)=>(T(),O("swiper-slide",{key:`img${v}`,lazy:"true"},[C(c,{src:f,class:"aspect-square object-cover"},null,8,["src"])]))),128))]),u("swiper-container",Lt,[u("swiper-slide",It,[u("img",{loading:"lazy",class:"object-cover aspect-square",src:o.product.imageUrl,alt:"產品圖"},null,8,Pt)]),(T(!0),O(V,null,Q(o.product.imagesUrl,(f,v)=>(T(),O("swiper-slide",{key:`img${v}`,lazy:"true"},[u("img",{class:"object-cover aspect-square",loading:"lazy",src:f,alt:"產品圖"},null,8,kt)]))),128))])]),u("div",Mt,[u("h2",Bt,I(o.product.title),1),u("p",Ct,I(o.product.unit),1),u("p",Wt,I(o.product.description),1),u("p",zt,"成分："+I(o.product.content),1),u("p",At,[u("span",Nt,[o.product.price!==o.product.origin_price?(T(),O(V,{key:0},[],64)):H("",!0),F(" NT$ "+I(o.product.price),1)]),o.product.price!==o.product.origin_price?(T(),O("del",Rt,"NT$ "+I(o.product.origin_price),1)):H("",!0)]),Vt,u("div",Ft,[u("button",{type:"button",class:"transition-colors hover:bg-primary-700 hover:text-primary-50 focus:bg-primary-700 focus:text-primary-50 active:bg-primary-700 active:text-primary-50 disabled:cursor-not-allowed disabled:bg-stone-100 disabled:text-stone-500",onClick:t[0]||(t[0]=f=>o.qty--),disabled:o.qty===1}," － ",8,Dt),K(u("input",{type:"text",class:"w-10 border-x border-y-0 border-primary-700 bg-transparent text-center focus:ring-primary-700","onUpdate:modelValue":t[1]||(t[1]=f=>o.qty=f),readonly:""},null,512),[[be,o.qty]]),u("button",{type:"button",class:"transition-colors hover:bg-primary-700 hover:text-primary-50 focus:bg-primary-700 focus:text-primary-50 active:bg-primary-700 active:text-primary-50 disabled:cursor-not-allowed disabled:bg-stone-100/50 disabled:text-stone-500",onClick:t[2]||(t[2]=f=>o.qty++)}," ＋ ")]),C(n,{class:"btn btn-primary mt-auto w-full",onClick:t[3]||(t[3]=X(f=>e.postCart(o.product.id,o.qty),["prevent"])),"is-loading":e.loadingStatus.productId===o.product.id},{default:R(()=>[F("加入購物車")]),_:1},8,["is-loading"])])]),u("div",qt,[Ut,C(d,{to:"/products",class:"link font-bold"},{default:R(()=>[F("查看所有商品 →")]),_:1})]),C(p)],512),[[he,Object.keys(o.product).length]])]),_:1})}const rr=ge(Tt,[["render",Xt],["__scopeId","data-v-a3d9ce09"]]);export{rr as default};
