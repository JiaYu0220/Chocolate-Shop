import{q as le,s as I,u as B,x as ce,y as ue,o as T,e as $,b as u,z as de,A as E,B as U,n as Y,C as G,g as N,_ as fe,m as W,a as me,d as M,F as D,i as Z,t as C,f as z,j as ge,D as pe,w as J,r as A,p as ve,k as he}from"./index-DSvEBgKx.js";import{l as K}from"./loadingStore-CRsAEdG-.js";import{c as be}from"./cartStore-CBZ03EbW.js";import{r as ye}from"./ProductCard-BKVl1Uwf.js";import{L as we}from"./LoadingBtn-BE7AR8Ew.js";import{P as xe}from"./ProductSwiper-CAaRsloJ.js";import{p as Se}from"./productStore-CkPDPtpV.js";import{s as Te}from"./swalStore-rAKyBXMr.js";var $e=Object.defineProperty,Oe=Object.defineProperties,je=Object.getOwnPropertyDescriptors,Q=Object.getOwnPropertySymbols,_e=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable,ee=(e,t,o)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ee=(e,t)=>{for(var o in t||(t={}))_e.call(t,o)&&ee(e,o,t[o]);if(Q)for(var o of Q(t))Ie.call(t,o)&&ee(e,o,t[o]);return e},Le=(e,t)=>Oe(e,je(t)),O=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ke="Expected a function",te=NaN,Pe="[object Symbol]",Me=/^\s+|\s+$/g,Ce=/^[-+]0x[0-9a-f]+$/i,Be=/^0b[01]+$/i,We=/^0o[0-7]+$/i,ze=parseInt,Ae=typeof O=="object"&&O&&O.Object===Object&&O,Ne=typeof self=="object"&&self&&self.Object===Object&&self,Re=Ae||Ne||Function("return this")(),Ve=Object.prototype,De=Ve.toString,qe=Math.max,Fe=Math.min,q=function(){return Re.Date.now()};function Ue(e,t,o){var s,r,v,d,n,c,p=0,g=!1,m=!1,x=!0;if(typeof e!="function")throw new TypeError(ke);t=re(t)||0,X(o)&&(g=!!o.leading,m="maxWait"in o,v=m?qe(re(o.maxWait)||0,t):v,x="trailing"in o?!!o.trailing:x);function b(i){var f=s,a=r;return s=r=void 0,p=i,d=e.apply(a,f),d}function L(i){return p=i,n=setTimeout(w,t),g?b(i):d}function k(i){var f=i-c,a=i-p,l=t-f;return m?Fe(l,v-a):l}function S(i){var f=i-c,a=i-p;return c===void 0||f>=t||f<0||m&&a>=v}function w(){var i=q();if(S(i))return j(i);n=setTimeout(w,k(i))}function j(i){return n=void 0,x&&s?b(i):(s=r=void 0,d)}function _(){n!==void 0&&clearTimeout(n),p=0,s=c=r=n=void 0}function P(){return n===void 0?d:j(q())}function y(){var i=q(),f=S(i);if(s=arguments,r=this,c=i,f){if(n===void 0)return L(c);if(m)return n=setTimeout(w,t),b(c)}return n===void 0&&(n=setTimeout(w,t)),d}return y.cancel=_,y.flush=P,y}function X(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function Xe(e){return!!e&&typeof e=="object"}function He(e){return typeof e=="symbol"||Xe(e)&&De.call(e)==Pe}function re(e){if(typeof e=="number")return e;if(He(e))return te;if(X(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=X(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Me,"");var o=Be.test(e);return o||We.test(e)?ze(e.slice(2),o?2:8):Ce.test(e)?te:+e}var Ye=Ue,se="Expected a function",oe=NaN,Ge="[object Symbol]",Ze=/^\s+|\s+$/g,Je=/^[-+]0x[0-9a-f]+$/i,Ke=/^0b[01]+$/i,Qe=/^0o[0-7]+$/i,et=parseInt,tt=typeof O=="object"&&O&&O.Object===Object&&O,rt=typeof self=="object"&&self&&self.Object===Object&&self,ot=tt||rt||Function("return this")(),it=Object.prototype,nt=it.toString,st=Math.max,at=Math.min,F=function(){return ot.Date.now()};function lt(e,t,o){var s,r,v,d,n,c,p=0,g=!1,m=!1,x=!0;if(typeof e!="function")throw new TypeError(se);t=ie(t)||0,R(o)&&(g=!!o.leading,m="maxWait"in o,v=m?st(ie(o.maxWait)||0,t):v,x="trailing"in o?!!o.trailing:x);function b(i){var f=s,a=r;return s=r=void 0,p=i,d=e.apply(a,f),d}function L(i){return p=i,n=setTimeout(w,t),g?b(i):d}function k(i){var f=i-c,a=i-p,l=t-f;return m?at(l,v-a):l}function S(i){var f=i-c,a=i-p;return c===void 0||f>=t||f<0||m&&a>=v}function w(){var i=F();if(S(i))return j(i);n=setTimeout(w,k(i))}function j(i){return n=void 0,x&&s?b(i):(s=r=void 0,d)}function _(){n!==void 0&&clearTimeout(n),p=0,s=c=r=n=void 0}function P(){return n===void 0?d:j(F())}function y(){var i=F(),f=S(i);if(s=arguments,r=this,c=i,f){if(n===void 0)return L(c);if(m)return n=setTimeout(w,t),b(c)}return n===void 0&&(n=setTimeout(w,t)),d}return y.cancel=_,y.flush=P,y}function ct(e,t,o){var s=!0,r=!0;if(typeof e!="function")throw new TypeError(se);return R(o)&&(s="leading"in o?!!o.leading:s,r="trailing"in o?!!o.trailing:r),lt(e,t,{leading:s,maxWait:t,trailing:r})}function R(e){var t=typeof e;return!!e&&(t=="object"||t=="function")}function ut(e){return!!e&&typeof e=="object"}function dt(e){return typeof e=="symbol"||ut(e)&&nt.call(e)==Ge}function ie(e){if(typeof e=="number")return e;if(dt(e))return oe;if(R(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=R(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=e.replace(Ze,"");var o=Ke.test(e);return o||Qe.test(e)?et(e.slice(2),o?2:8):Je.test(e)?oe:+e}var ne=ct;const ft=["src"],mt={inheritAttrs:!1},H=le(Le(Ee({},mt),{props:{src:{default:""},width:{default:"100%"},height:{default:"auto"},className:{default:""},zoomImgSrc:{default:""},zoomFactor:{default:1.5},mgWidth:{default:150},mgHeight:{default:150},mgBorderWidth:{default:2},mgShape:{default:"circle"},mgShowOverflow:{type:Boolean,default:!0},mgMouseOffsetX:{default:0},mgMouseOffsetY:{default:0},mgTouchOffsetX:{default:()=>-50},mgTouchOffsetY:{default:()=>-50},mgShow:{type:Boolean,default:!0},mgCornerBgColor:{default:"#fff"}},emits:["image:load"],setup(e,{emit:t}){const o=I();let s=I(new DOMRect),r=I(!1),v=I(0),d=I(0),n=I(0),c=I(0);const p=B(()=>{let a="vue-magnifier__magnifying-glass";return r.value&&(a+=" vue-magnifier__visible"),e.mgShape==="circle"&&(a+=" vue-magnifier__circle"),a}),g=B(()=>({width:e.width,height:e.height,overflow:e.mgShowOverflow?"visible":"hidden"})),m=B(()=>({cursor:e.mgShow?"none":"",width:"100%",height:"100%"})),x=B(()=>({width:`${e.mgWidth}px`,height:`${e.mgHeight}px`,left:`calc(${n.value*100}% - ${e.mgWidth/2}px + ${v.value}px - ${e.mgBorderWidth}px)`,top:`calc(${c.value*100}% - ${e.mgHeight/2}px + ${d.value}px - ${e.mgBorderWidth}px)`,backgroundImage:`url(${e.zoomImgSrc||e.src})`,backgroundPosition:`calc(${n.value*100}% + ${e.mgWidth/2}px - ${n.value*e.mgWidth}px) calc(${c.value*100}% + ${e.mgHeight/2}px - ${c.value*e.mgWidth}px)`,backgroundSize:`${e.zoomFactor*s.value.width}% ${e.zoomFactor*s.value.height}%`,borderWidth:`${e.mgBorderWidth}px`,backgroundColor:e.mgCornerBgColor})),b=()=>{o.value&&(s.value=o.value.getBoundingClientRect())},L=a=>{t("image:load",a),b()},k=()=>{b()};let S=a=>{if(s.value){const l=a.target;v.value=e.mgMouseOffsetX,d.value=e.mgMouseOffsetY,n.value=(a.clientX-s.value.left)/l.clientWidth,c.value=(a.clientY-s.value.top)/l.clientHeight,r.value=!0}};const w=()=>{r.value=!1},j=()=>{b()};let _=a=>{if(s.value){const l=a.target,h=(a.targetTouches[0].clientX-s.value.left)/l.clientWidth,V=(a.targetTouches[0].clientY-s.value.top)/l.clientHeight;h>=0&&V>=0&&h<=1&&V<=1?(v.value=e.mgTouchOffsetX,d.value=e.mgTouchOffsetY,n.value=h,c.value=V,r.value=!0):r.value=!1}};const P=()=>{r.value=!1},y=Ye(b,200);S=ne(S,20,{trailing:!1}),_=ne(_,20,{trailing:!1});const i=()=>{window.addEventListener("resize",y),window.addEventListener("scroll",y,!0)},f=()=>{window.removeEventListener("resize",y),window.removeEventListener("scroll",y,!0)};return ce(()=>{i()}),ue(()=>{f()}),(a,l)=>(T(),$("div",{class:Y(`vue-magnifier__magnifier ${e.className}`),style:G(E(g))},[u("img",de({ref_key:"img",ref:o,src:e.src},a.$attrs,{class:"vue-magnifier__magnifier-image",style:E(m),onLoad:l[0]||(l[0]=h=>L(h)),onMouseenter:l[1]||(l[1]=h=>k()),onMousemove:l[2]||(l[2]=h=>E(S)(h)),onMouseout:l[3]||(l[3]=h=>w()),onTouchstart:l[4]||(l[4]=U(h=>j(),["prevent"])),onTouchmove:l[5]||(l[5]=U(h=>E(_)(h),["prevent"])),onTouchend:l[6]||(l[6]=h=>P())}),null,16,ft),s.value&&e.mgShow?(T(),$("div",{key:0,class:Y(E(p)),style:G(E(x))},null,6)):N("",!0)],6))}}));H.install=e=>{e.component("VueMagnifier",H)};var gt={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"jiayu",BASE_URL:"/Chocolate-Shop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:pt,VITE_PATH:vt}=gt,ht={props:["id"],components:{LoadingBtn:we,ProductSwiper:xe,VueMagnifier:H},data(){return{product:{},qty:1}},mounted(){ye(),this.init()},watch:{"$route.params.id":{handler(){this.init()},deep:!0}},methods:{async init(){this.showLoading();const e=[this.getAllProducts(),this.getSingleProduct()];(await Promise.allSettled(e)).forEach(o=>{o.status==="rejected"&&(this.hideLoading(),this.$swal(o.response.data))}),this.hideLoading()},async getSingleProduct(){try{const e=`${pt}/api/${vt}/product/${this.id}`,t=await this.$http.get(e);this.product=t.data.product}catch(e){this.hideLoading(),this.apiErrorSwal(e)}},...W(be,["postCart"]),...W(K,["showLoading","hideLoading"]),...W(Se,["getAllProducts"]),...W(Te,["apiErrorSwal"])},computed:{...me(K,["loadingStatus"])}},ae=e=>(ve("data-v-320751a6"),e=e(),he(),e),bt={key:0,class:"container py-10"},yt={class:"flex flex-col pb-16 sm:flex-row"},wt={class:"h-96 pb-5 sm:w-1/2 sm:pb-0 sm:pr-4 md:h-[500px]"},xt={class:"mx-auto h-4/5 w-full *:overflow-hidden *:rounded-sm","thumbs-swiper":".thumbs","space-between":"10",navigation:"true"},St={lazy:"true"},Tt={class:"thumbs h-1/5 pt-2 *:h-full *:w-1/4 *:cursor-pointer *:overflow-hidden *:rounded-sm *:opacity-40","slides-per-view":"4","free-mode":"true","space-between":"10","watch-slides-progress":"true"},$t={lazy:"true"},Ot=["src"],jt=["src"],_t={class:"relative flex flex-col justify-between sm:w-1/2 sm:pl-4"},It={class:"mb-3 text-2xl font-bold text-primary-800"},Et={class:"mb-5"},Lt={class:"mb-5"},kt={class:"mb-5"},Pt={class:"mr-1 text-2xl text-primary-800"},Mt={key:0},Ct=ae(()=>u("p",null,"數量",-1)),Bt={class:"mb-5 flex w-fit rounded border-2 border-primary-700 *:px-3 *:py-2"},Wt=["disabled"],zt={class:"mb-5 flex items-center justify-between"},At=ae(()=>u("h2",{class:"text-xl font-bold text-primary-800"},"推薦商品",-1));function Nt(e,t,o,s,r,v){const d=A("VueMagnifier"),n=A("LoadingBtn"),c=A("RouterLink"),p=A("ProductSwiper");return Object.keys(r.product).length?(T(),$("div",bt,[u("div",yt,[u("div",wt,[u("swiper-container",xt,[u("swiper-slide",St,[M(d,{src:r.product.imageUrl,mgShape:"square",class:"aspect-square object-cover"},null,8,["src"])]),(T(!0),$(D,null,Z(r.product.imagesUrl,(g,m)=>(T(),$("swiper-slide",{key:`img${m}`,lazy:"true"},[M(d,{src:g,class:"aspect-square object-cover"},null,8,["src"])]))),128))]),u("swiper-container",Tt,[u("swiper-slide",$t,[u("img",{loading:"lazy",class:"h-full w-full object-cover",src:r.product.imageUrl,alt:"產品圖"},null,8,Ot)]),(T(!0),$(D,null,Z(r.product.imagesUrl,(g,m)=>(T(),$("swiper-slide",{key:`img${m}`,lazy:"true"},[u("img",{class:"h-full w-full object-cover",loading:"lazy",src:g,alt:"產品圖"},null,8,jt)]))),128))])]),u("div",_t,[u("h2",It,C(r.product.title),1),u("p",Et,C(r.product.unit),1),u("p",Lt,C(r.product.description),1),u("p",kt,[u("span",Pt,[r.product.price!==r.product.origin_price?(T(),$(D,{key:0},[z("特惠")],64)):N("",!0),z(" NT$ "+C(r.product.price),1)]),r.product.price!==r.product.origin_price?(T(),$("del",Mt,"NT$ "+C(r.product.origin_price),1)):N("",!0)]),Ct,u("div",Bt,[u("button",{type:"button",class:"transition-colors hover:bg-primary-700 hover:text-primary-50 focus:bg-primary-700 focus:text-primary-50 active:bg-primary-700 active:text-primary-50 disabled:cursor-not-allowed disabled:bg-stone-100 disabled:text-stone-500",onClick:t[0]||(t[0]=g=>r.qty--),disabled:r.qty===1}," － ",8,Wt),ge(u("input",{type:"text",class:"w-10 border-x border-y-0 border-primary-700 bg-transparent text-center focus:ring-primary-700","onUpdate:modelValue":t[1]||(t[1]=g=>r.qty=g),readonly:""},null,512),[[pe,r.qty]]),u("button",{type:"button",class:"transition-colors hover:bg-primary-700 hover:text-primary-50 focus:bg-primary-700 focus:text-primary-50 active:bg-primary-700 active:text-primary-50 disabled:cursor-not-allowed disabled:bg-stone-100/50 disabled:text-stone-500",onClick:t[2]||(t[2]=g=>r.qty++)}," ＋ ")]),M(n,{class:"btn btn-primary mt-auto w-full",onClick:t[3]||(t[3]=U(g=>e.postCart(r.product.id,r.qty),["prevent"])),"is-loading":e.loadingStatus.productId===r.product.id},{default:J(()=>[z("加入購物車")]),_:1},8,["is-loading"])])]),u("div",zt,[At,M(c,{to:"/products",class:"link font-bold"},{default:J(()=>[z("查看所有商品 →")]),_:1})]),M(p)])):N("",!0)}const Yt=fe(ht,[["render",Nt],["__scopeId","data-v-320751a6"]]);export{Yt as default};
