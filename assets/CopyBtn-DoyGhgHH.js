import{F as I}from"./FormFloat-CeWoF_W0.js";import{I as F}from"./LoadingBtn-Cg_DCWH5.js";import{a as M,_ as b,o as l,e as u,g,b as n,d,n as _,h as f,f as k,w as c,z as N,k as x,v as C,c as S,F as D,u as T,T as B,t as L}from"./index-DTQ0iRKP.js";import{l as A}from"./loadingStore-JENbuUSr.js";import{C as V}from"./AdminActionBtns-FfIeA5xV.js";var z={VITE_URL:"https://ec-course-api.hexschool.io/v2",VITE_PATH:"jiayu",BASE_URL:"/Chocolate-Shop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:w,VITE_PATH:v}=z,E={data(){return{isDragfile:!1}},components:{IconLoading:F},props:{returnUrl:{type:Boolean,default:!1},isMultiple:{type:Boolean,default:!1},isLoading:{type:Boolean}},methods:{handleChange(i){this.returnUrl?this.isMultiple?this.uploadMultiImg(i):this.uploadImg(i):this.$emit("emitChange",i)},async uploadImg(i){try{this.loadingStatus.imageUrl=!0;const t=i.target.files[0],o=new FormData;o.append("file-to-upload",t);const p=`${w}/api/${v}/admin/upload`,{data:e}=await this.$http.post(p,o);this.$emit("emitChange",e.imageUrl),this.loadingStatus.imageUrl=!1}catch(t){this.loadingStatus.imageUrl=!1;const{message:o}=t.response.data;this.$swal(Array.isArray(o)?o[0]:o)}},async uploadMultiImg(i){try{this.loadingStatus.imagesUrl=!0;const{files:t}=i.target,o=`${w}/api/${v}/admin/upload`,p=Object.values(t).map(async m=>{const s=new FormData;return s.append("file-to-upload",m),(await this.$http.post(o,s)).data.imageUrl}),e=await Promise.all(p);this.$emit("emitChange",e);const a=i.target;a.value="",this.loadingStatus.imagesUrl=!1}catch(t){this.loadingStatus.imagesUrl=!1;const{message:o}=t.response.data;this.$swal(Array.isArray(o)?o[0]:o)}}},computed:{...M(A,["loadingStatus"])}},R=n("i",{class:"bi bi-file-earmark-image-fill text-2xl"},null,-1),j=n("p",null,"請拖曳圖片檔案到此區，或點擊後選取圖片檔案",-1),P={key:0},H=n("p",null,"PNG、JPG、JPEG",-1),O=["multiple","disabled"],W={key:1,class:"absolute w-full h-full bg-primary-50 opacity-80 flex items-center justify-center"};function G(i,t,o,p,e,a){const m=f("IconLoading");return l(),u("label",{for:"imageInput",class:_(["flex flex-col items-center justify-center p-4 text-stone-400 text-center border-4 rounded-md cursor-pointer w-full relative duration-150 text-sm md:text-base hover:bg-stone-100",e.isDragfile?"border-primary-300":"border-stone-300 border-dashed"])},[R,j,o.isMultiple?(l(),u("p",P,"可上傳多個檔案")):g("",!0),H,n("input",{class:"opacity-0 absolute w-full h-full cursor-pointer",type:"file",accept:".png, .jpg, .jpeg",id:"imageInput",ref:"imageFile",title:"",multiple:o.isMultiple,disabled:o.isLoading,onChange:t[0]||(t[0]=s=>a.handleChange(s)),onDragover:t[1]||(t[1]=s=>e.isDragfile=!0),onDrop:t[2]||(t[2]=s=>e.isDragfile=!1),onDragleave:t[3]||(t[3]=s=>e.isDragfile=!1)},null,40,O),o.isLoading?(l(),u("div",W,[d(m,{size:"lg"})])):g("",!0)],2)}const $=b(E,[["render",G]]),J={data(){return{previews:{},cropperUrl:"",fileName:this.downName,option:{img:"",info:!0,outputSize:1,full:!0,outputType:"png",original:!1,canScale:!1,canMove:!1,canMoveBox:!0,autoCrop:!0,autoCropWidth:750,autoCropHeight:500,centerBox:!0,high:!0,maxImgSize:99999,mode:"contain"},fixed:!0,fixedNumber:[4,3]}},components:{FormFloat:I,FileInput:$,CenterModal:V},props:{downName:String},watch:{downName(){this.fileName=this.downName}},methods:{upload(i){if(i.target.files.length){const t=i.target.files[0],o=new FileReader;o.onload=p=>{const e=window.URL.createObjectURL(new Blob([p.target.result]));this.option.img=e},o.readAsArrayBuffer(t)}},download(){const i=document.createElement("a");i.download=this.fileName,this.$refs.cropper.getCropBlob(t=>{this.cropperUrl=window.URL.createObjectURL(t),i.href=this.cropperUrl,i.click()})},clear(){this.option.img=""}}},q=n("i",{class:"bi bi-scissors mr-1"},null,-1),K=n("p",{class:"mb-2"},"請選擇圖片檔案或貼上圖片網址：",-1),Q=n("i",{class:"bi bi-x text-xl"},null,-1),X=[Q],Y={key:0,class:"w-full h-[200px] md:h-[400px]"},Z={class:"flex mt-5"};function ee(i,t,o,p,e,a){const m=f("FileInput"),s=f("FormFloat"),y=f("VueCropper"),U=f("CenterModal");return l(),u(D,null,[n("button",{type:"button",class:"btn btn-primary-light",onClick:t[0]||(t[0]=r=>i.$refs.cropperModal.showModal())},[q,k("裁剪圖片小工具 ")]),d(U,{ref:"cropperModal",target:"cropperModal","close-attach-method":a.clear},{title:c(({titleClass:r})=>[n("h3",{class:_(r)},"裁剪圖片小工具",2)]),default:c(()=>[K,d(m,{onEmitChange:a.upload,class:"mb-3"},null,8,["onEmitChange"]),d(s,{"label-for":"imgUrl",label:"圖片網址",class:"mb-3"},N({default:c(({inputClass:r})=>[x(n("input",{type:"text",name:"圖片",id:"imgUrl",class:_(r),"onUpdate:modelValue":t[1]||(t[1]=h=>e.option.img=h),placeholder:""},null,2),[[C,e.option.img]])]),_:2},[e.option.img?{name:"icon",fn:c(({iconClass:r})=>[n("button",{type:"button",class:_(r),onClick:t[2]||(t[2]=(...h)=>a.clear&&a.clear(...h))},X,2)]),key:"0"}:void 0]),1024),e.option.img?(l(),u("div",Y,[d(y,{ref:"cropper",img:e.option.img,"center-wrapper":"","output-size":e.option.outputSize,"output-type":e.option.outputType,info:e.option.info,full:e.option.full,fixed:e.fixed,"fixed-number":e.fixedNumber,"can-move":e.option.canMove,"can-move-box":e.option.canMoveBox,"can-scale":e.option.canScale,original:e.option.original,"auto-crop":e.option.autoCrop,autoCropWidth:e.option.autoCropWidth,autoCropHeight:e.option.autoCropHeight,"center-box":e.option.centerBox,high:e.option.high,"max-img-size":e.option.maxImgSize,mode:e.option.mode},null,8,["img","output-size","output-type","info","full","fixed","fixed-number","can-move","can-move-box","can-scale","original","auto-crop","autoCropWidth","autoCropHeight","center-box","high","max-img-size","mode"])])):g("",!0),n("div",Z,[e.option.img?(l(),S(s,{key:0,"label-for":"fileName",label:"下載的檔案名稱",class:"flex-grow"},{default:c(({inputClass:r})=>[x(n("input",{type:"text",name:"檔案名稱",id:"fileName",class:_(["rounded-r-none",r]),"onUpdate:modelValue":t[3]||(t[3]=h=>e.fileName=h),placeholder:""},null,2),[[C,e.fileName]])]),_:1})):g("",!0),e.option.img?(l(),u("button",{key:1,type:"button",class:"btn btn-primary rounded-l-none text-nowrap",onClick:t[4]||(t[4]=(...r)=>a.download&&a.download(...r))},"下載")):g("",!0)])]),_:1},8,["close-attach-method"])],64)}const fe=b(J,[["render",ee]]),te={};function oe(i,t){return l(),S(B,{name:"fade","enter-active-class":"animate__animated animate__fadeIn animate__faster","leave-active-class":"animate__animated animate__fadeOut animate__faster",onAfterLeave:t[0]||(t[0]=o=>i.$emit("onAfterLeave"))},{default:c(()=>[T(i.$slots,"default")]),_:3})}const ie=b(te,[["render",oe]]),ne={data(){return{isCopy:!1}},components:{TransitionFade:ie},props:{text:{type:String},msg:{type:String}},methods:{async copy(i){try{await navigator.clipboard.writeText(i),this.isCopy=!0,setTimeout(()=>{this.isCopy=!1},700)}catch{}}}},ae={class:"relative"},se=n("i",{class:"bi bi-copy"},null,-1),re={key:0,class:"isolate absolute bottom-full right-0 p-1 m-1 bg-primary-100 text-primary-800 rounded z-10 text-nowrap text-sm shadow-sm"};function le(i,t,o,p,e,a){const m=f("TransitionFade");return l(),u("button",{type:"button",onClick:t[0]||(t[0]=s=>a.copy(o.text))},[n("div",ae,[se,d(m,null,{default:c(()=>[e.isCopy?(l(),u("div",re," 已複製"+L(o.msg),1)):g("",!0)]),_:1})])])}const ge=b(ne,[["render",le]]);export{ge as C,$ as F,fe as a};
